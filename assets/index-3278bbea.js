(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const y of i.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&c(y)}).observe(document,{childList:!0,subtree:!0});function o(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(t){if(t.ep)return;t.ep=!0;const i=o(t);fetch(t.href,i)}})();const s="https://safemoney.onrender.com";async function O(){return await(await fetch(s+"/money")).json()}async function b(e){if(!(await fetch(s+"/money",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).ok)throw"error happend";return!0}async function T(e){if(!(await fetch(s+"/money",{method:"DELETE",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).ok)throw"error happend";return!0}async function S(){let e=await fetch(s+"/config");if(e.ok)return await e.json();throw"Error"}S();async function w({id:e,total:n}){try{if(!(await fetch(s+"/config",{method:"PUT",body:JSON.stringify({total:n,id:e}),headers:{"Content-Type":"application/json"}})).ok)throw"error";return!0}catch{return!1}}let g=[];(async()=>(g=await O(),l()))();const B=document.getElementById("total"),q=document.getElementById("zoom-in"),z=document.getElementById("zoom-out"),v=document.getElementById("saleInput"),I=document.getElementById("priceInput"),x=document.getElementById("after-desc"),a=document.querySelector("table tbody"),k=document.getElementById("add"),p=document.getElementById("save-changes"),C=document.getElementById("back-from-settings"),D=document.getElementById("settings-btn"),h=document.getElementById("config"),u=document.getElementById("inputTotal"),r=document.getElementById("save-total"),E=document.getElementById("loading-span"),N=document.querySelector(".loading-screen");let m={total:0},d=[],f=[];const j=()=>"id"+Math.random().toString(16).slice(2);function P({sale:e,price:n,idx:o}){return`
    <td>${e}</td>
    <td>${n}</td>
      <td class="tdDelete"><button data-td="${o}">حذف</button></td>
    
    `}function l(){a.innerHTML="";let e=0;g.forEach(({price:n,sale:o},c)=>{e+=Number(n);let t=document.createElement("tr");t.innerHTML=P({sale:o,price:n,idx:c}),t.querySelector("button").onclick=M,a.append(t)}),x.innerText=`بعد الخصم ${m.total-e}`}function M(e){var c;let n=Number(e.target.dataset.td),o=g.splice(n,1);if((c=o[0])!=null&&c._id)f.push(o[0]._id);else{let t=d.findIndex(i=>i.id===o[0].id);d.splice(t,1)}p.disabled=!1,l()}function $(){if(!v.value.trim()||!I.value.trim())return;let e={sale:v.value,price:I.value,id:j()};g.push(e),p.disabled=!1,d.push(e),l()}async function A(){if(E.innerText="loading ...",p.disabled=!0,d.length>0)try{await b(d)}catch{}if(E.innerText="loading ...",f.length>0){try{await b(d)}catch{}await T(f)}d.length=0,f.length=0,E.innerText=""}function J(){let e=parseInt(getComputedStyle(a).fontSize);if(e>=38)return a.style.fontSize=38;a.style.fontSize=e+5}function _(){let e=parseInt(getComputedStyle(a).fontSize);if(e<=12)return a.style.fontSize=12;a.style.fontSize=e-5}function L(){h.classList.contains("hide")?h.classList.remove("hide"):h.classList.add("hide")}function F(){var n,o;let e=(o=(n=r==null?void 0:r.dataset)==null?void 0:n.configId)==null?void 0:o.trim();e&&(B.innerText=u.value,m.total=u.value,l(),r.disabled=!0,w({total:u.value,id:e}))}function H(e){e.target.value.trim()?r.disabled=!1:r.disabled=!0}(async()=>{try{let e=await S();m.total=e.total,B.innerText=m.total,r.dataset.configId=e._id,N.classList.add("hide"),l()}catch(e){console.log(e),document.querySelector(".loading-screen h2").innerText="خطأ في تحميل الصفحة يرجى المحاولة في وقت لاحق"}})();q.addEventListener("click",J);z.addEventListener("click",_);p.addEventListener("click",A);k.addEventListener("click",$);D.addEventListener("click",L);C.addEventListener("click",L);r.addEventListener("click",F);u.addEventListener("input",H);
